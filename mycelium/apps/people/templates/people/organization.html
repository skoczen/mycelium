{% extends "people/base.html" %}
{% load i18n generic_fields friendly_data_formatting %}
{% block title %}Organizations - {% if org.name %}{{org.name}}{% else %}New Organization{% endif %}{% endblock %}
{% block css %}{{block.super}}
{% generic_field_css %}
 <link rel="stylesheet" href="{{ MEDIA_URL }}css/people_organizations.css" type="text/css" media="screen" title="" charset="utf-8">
{% endblock %}
{% block javascript %}{{block.super}}
<script type="text/javascript" charset="utf-8" src="{{MEDIA_URL}}js/mycelium/people_person.js"> </script>
<script type="text/javascript" charset="utf-8" src="{{MEDIA_URL}}js/mycelium/people_organization.js"> </script>
{% if request.GET.edit == "ON" %}
<script type="text/javascript" charset="utf-8">
$(function(){
	toggle_edit();
});
</script>
{% endif %}

{% endblock %}
{% block breadcrumb_links %}<a href="{% url people:search %}" >Back to All People and Organizations</a>{% endblock %}
{% block page_content %}

{% with "Edit Organization" as edit_label %}
{% include "people/_save_status_and_button.html" %}
{% endwith %}

<form action="{% url people:organization_save_basic org.pk %}" class="edit_mode_off" id="basic_info_form" method="POST">
<div class="basic_info">
	<div class="name_phone_email">
		<div class="name">
			{% generic_editable_field form.name %}
		</div>
		{% generic_editable_field form.primary_phone_number %}
		{# {% generic_editable_field form.organization_type %} #}
		{# {% generic_editable_field form.organization_type_other_name %} #}
		{% generic_editable_field_url form.website %}
		{% generic_editable_field_twitter form.twitter_username %}		
	</div>
	<div class="address">
		{% generic_editable_field form.line_1 %}
		{% generic_editable_field form.line_2 %}

		<div class="city_state_zip">
			{% generic_editable_field form.city %}<span class="city_state_comma">,</span>
			{% generic_editable_field form.state %}
			{% generic_editable_field form.postal_code %}
		</div>
	
	</div>

</div>
</form>


<div class="additional_information">
	{# Extra emails, phone #s, Addresses #}
</div>
	
	
<div id="detail_tabs">
	<a class="detail_tab" href="#">Conversations</a>
	<a class="detail_tab" href="#">Activity</a>
	<a class="detail_tab current" href="#">People</a>
	{# <a class="detail_tab" href="#">Participant</a> #}
	{# <a class="detail_tab current" href="#">Volunteer</a> #}
	<a class="detail_tab" href="#">Donor</a>
</div>
<div id="detail_tab_contents">
<div class="tab_contents organizations_people">
	<a href="#" class="add_new_person_btn mycelium_btn">Add a Person</a>
	<div class="add_person_container">
	<div id="search_for_person">
		<section_title>Add a Person</section_title>
		<instructions>Search for someone in GoodCloud, or add someone new.</instructions>
		<input type="search" results=5 name="new_person_name" id="id_search_new_person" placeholder="Search by name, email, or phone number" results_url="{% url people:add_person_via_organization_search_results %}">
		<fragment name="new_person_search_results" action="replace">
			{% include "people/_add_person_to_org_results.html" %}
		</fragment>
	</div>

	<div id="add_existing_person">
		<section_title>Role Details</section_title>		
		<form action="{% url people:existing_person_via_organization org.pk %}" method="POST">{% csrf_token %}
			<span class="edit_mode_on">
			<input type="hidden" name="person_pk" value=""/>
			<span class="full_name"></span>
			{% generic_editable_field form_employee.role %}
			{% generic_editable_field form_employee.email %}
			{% generic_editable_field form_employee.phone_number %}
			</span>
		<form_actions>
			<input type="submit" class="mycelium_btn" value="Add Person"/>
		</form_actions>
		</form>
	</div>
	<div id="new_person">
		<section_title>Role Details</section_title>
		<form action="{% url people:new_person_via_organization org.pk %}" method="POST">{% csrf_token %}
			<span class="edit_mode_on">
			{% generic_editable_field form_new_person.first_name %}
			{% generic_editable_field form_new_person.last_name %}

			{% generic_editable_field form_employee.role %}
			{% generic_editable_field form_employee.email %}
			{% generic_editable_field form_employee.phone_number %}
			</span>
		<form_actions>
			<input type="submit" class="mycelium_btn" value="Add Person"/>
		</form_actions>
		</form>
	</div>
	</div>
	<employees>
	{% for e in org.employees.all %}
	<employee>
	
		<span class="name"><a href="{% url people:person e.person.pk %}" class="mycelium_crosslink_btn">{{e.person.full_name}}</a></span>
		<span class="title">{{e.role}}</span>
		<span class="phone">{{e.phone_number}}</span>
		<span class="email">{{e.email}}</span>
	</employee>
	{% endfor %}
	</employees>
</div>
</div>
{% endblock %}