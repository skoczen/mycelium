{% extends "mycelium_base.html" %}
{% load i18n %}
{% block title %}Dashboard{% endblock %}
{% block css %}{{block.super}}
{% compress css %}
<link rel="stylesheet" href="{{STATIC_URL}}css/generic_fields.css" type="text/css" media="screen, projection"/>
<link rel="stylesheet" href="{{STATIC_URL}}css/dashboard.css" type="text/css" media="screen, projection"/>
{% endcompress %}
{% endblock %}
{% block javascript %}{{block.super}}
{% compress js %}
<script src="{{STATIC_URL}}js/mycelium/dashboard.js"></script>
<script src="{{STATIC_URL}}js/mycelium/conversation_and_gist.js"></script>
{% endcompress %}
{% endblock %}

{% block breadcrumb %}{% endblock %}
{% block page_content %}
<dashboard>
{# <div class="dashboard_title">Welcome to GoodCloud.</div> #}
<salutation>{% if not request.useraccount.nickname %}Hello <span class="full_name">{{request.useraccount.full_name}}</span>,{% else %}Hi {{request.useraccount.nickname}}!{% endif %}</salutation>
{% if not request.useraccount.nickname %}
	<div class="nickname_question" save_url="{% url dashboard:save_nickname %}">
		<div class="initial_question">
		(Would it be ok if we called you <span class="nickname_guess">{{request.useraccount.best_nickname_guess}}</span>? 
		<a href="#" class="yes_to_nickname">Yes</a>
		<a href="#" class="no_to_nickname">No</a>)
		</div>
		<div class="nickname_no_followup edit_mode_on">
		<div class="followup_question">Got it. What would you prefer? </div>
		<input id="id_new_nickname" name="new_nickname" value="{{request.useraccount.full_name}}" />
		<a href="#" class="mycelium_btn save_new_nickname">Save</a>
		</div>

	</div>
{% endif %}



<table class="dashboard_panel_table">
<tr>

	<td class="left_col">
		<column_header class="conversations">Recent Conversations</column_header>
		<column_content class="plain_text conversations">
		<fragment name="more_conversations" action="append">
		{% include "dashboard/_recent_conversations.html" %}
		</fragment>
		{% if recent_conversations %}
		<a href="{% url dashboard:more_conversations %}" class="more_conversations_link">More Conversations</a>
		{% endif %}
		</column_content>

		{# <column_header class="news">GoodCloud News</column_header> #}
		{# {% include "dashboard/_goodcloud_news.html" %} #}
	</td>
	<td class="right_col">

		<column_header class="birthdays">Birthdays</column_header>
		<column_content>
		{% for p in request.account.upcoming_birthdays %}
			<div class="birthday_row">		
				<div class="birthday_date">{% ifchanged p.birthday_abbrev_month_day_text %}{{p.birthday_abbrev_month_day_text}}{% endifchanged %}</div>
				<div class="person_and_age">
					<a href="{% url people:person p.pk %}" class="name">{{p.full_name}}</a>
					{% if p.age %}<span class="age"> turns <span class="number">{{p.next_or_todays_birthday_age}}</span></span>{% endif %}
				</div>
			</div>
		{% empty %}
			<div class="no_birthdays">None in the next month!</div>
		{% endfor %}
		</column_content>
		<column_header class="numbers">By the Numbers</column_header>
		{% include "dashboard/_the_numbers.html" %}
	</td>

</tr>
</table>
</dashboard>
{% endblock %}