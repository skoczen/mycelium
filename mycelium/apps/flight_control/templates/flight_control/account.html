{% extends "flight_control/base.html" %}
{% load i18n flip_clock humanize pagination_tags %}
{% block title %}Dashboard for {{account.name}}{% endblock %}

{% block page_content %}

<div class="container">
	<div class="row">
		<span class="name_and_info ninecol">
			<div class="name">{{account.name}}</div>
			<div class="url">{{account.subdomain}}.agoodcloud.com</div>
		</span>
		<span class="active threecol">
			{% flip_clock account.age_in_months "Months"  %}
		</span>
	</div>
</div>

<div class="container info_columns">
	<div class="row">
		<column class="fourcol billing_issues">
			<column_header>Users</column_header>
			<table class="info_block">
			{% with account.useraccount_set.all as users %}
			{% autopaginate users 15 %}
			{% for u in users %}
			<tr class="account_info_block">
				<td>{{u.full_name}}</td>
				<td>{{u.denamespaced_username}}</td>
				<td><a href="mailto:{{u.user.email}}">Email</a></td>
			</div>
			{% endfor %}
			</table>
			{% paginate %}
			{% endwith %}
		</column>
		<column class="fourcol recent_activity">
			<column_header>Recent Activity</column_header>
			<div class="info_block">
				Steven Skoczen edited a person. <span class="when">15 minutes ago</span>
			</div>
			<div class="info_block">
				Steven Skoczen created a group. <span class="when">22 minutes ago</span>
			</div>
			<div class="info_block">
				Tom Noble imported a spreadsheet. <span class="when">47 minutes ago</span>
			</div>

		</column>
		<column class="fourcol averages">
			<column_header>Billing</column_header>
			<div class="info_block">
				Signup Date: {{account.signup_date|date}}
			</div>
			<div class="info_block">
				Last Billed: {{account.last_billing_date|date}}
			</div>
			<div class="info_block">
				Next Billed: {{account.chargify_next_assessment_at|date}}
			</div>
			<div class="info_block">
				Account Balance: ${{account.chargify_balance|floatformat:2|intcomma}}
			</div>
			<column_header>Account Averages</column_header>
			<average class="info_block number_row">
				<number>{{num_people|floatformat:0|intcomma}}</number>
				<description>People</description>
			</average>

			<average class="info_block number_row">
				<number>{{num_organizations|floatformat:0|intcomma}}</number>
				<description>Organizations</description>
			</average>

			<average class="info_block number_row">
				<number>{{num_donations|floatformat:0|intcomma}}</number>
				<description>Donations</description>
			</average>
			<average class="info_block number_row">
				<number>${{avg_donation|floatformat:2|intcomma}}</number>
				<description>Per Donation</description>
			</average>
			<average class="info_block number_row">
				<number>{{num_volunteer_hours|floatformat:0|intcomma}}</number>
				<description>Volunteer Hours</description>
			</average>
			<average class="info_block number_row">
				<number>{{avg_vol_hours_per_person|floatformat:1|intcomma}}</number>
				<description>Volunteer Hours per person</description>
			</average>
			
			<average class="info_block number_row">
				<number>{{num_tags|floatformat:0|intcomma}}</number>
				<description>Tags</description>
			</average>
			<average class="info_block number_row">
				<number>{{avg_tags_per_person|floatformat:1|intcomma}}</number>
				<description>Tags per Person</description>
			</average>
			<average class="info_block number_row">
				<number>{{num_groups|floatformat:1|intcomma}}</number>
				<description>Groups</description>
			</average>
			<average class="info_block number_row">
				<number>{{num_spreadsheets|floatformat:1|intcomma}}</number>
				<description>Spreadsheets</description>
			</average>
		</column>
	</div>
</div>


{% endblock %}